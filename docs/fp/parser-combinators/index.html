<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">Parser Combinators | Grox</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://grokking-vietnam.github.io//grox/docs/fp/parser-combinators"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Parser Combinators | Grox"><meta data-react-helmet="true" name="description" content="Introduction"><meta data-react-helmet="true" property="og:description" content="Introduction"><link data-react-helmet="true" rel="icon" href="/grox/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://grokking-vietnam.github.io//grox/docs/fp/parser-combinators"><link data-react-helmet="true" rel="alternate" href="https://grokking-vietnam.github.io//grox/docs/fp/parser-combinators" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://grokking-vietnam.github.io//grox/docs/fp/parser-combinators" hreflang="x-default"><link rel="stylesheet" href="/grox/assets/css/styles.d0db87f0.css">
<link rel="preload" href="/grox/assets/js/runtime~main.cc110788.js" as="script">
<link rel="preload" href="/grox/assets/js/main.f2131e7f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/grox/"><div class="navbar__logo"><img src="https://avatars.githubusercontent.com/u/9639466?s=45&amp;v=4" alt="Grox Language Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="https://avatars.githubusercontent.com/u/9639466?s=45&amp;v=4" alt="Grox Language Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Grox</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/grox/docs">Learn</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/grokking-vietnam/grox" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">üåú</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">üåû</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/grox/docs/">M·ª•c l·ª•c</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/grox/docs/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/grox/docs/book/lox-language">Crafting Interpeters</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/grox/docs/fp/parser-combinators">Functional Programming</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/grox/docs/fp/parser-combinators">Parser Combinators</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/grox/docs/resources">Resources</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Parser Combinators</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">‚Äã</a></h2><p>Trong b√†i n√†y, m√¨nh s·∫Ω tr√¨nh b√†y v·ªÅ parser combinators m·ªôt k·ªπ thu·∫≠t th∆∞·ªùng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Functional Programming khi gi·∫£i quy·∫øt c√°c b√†i to√°n parsing. N·∫øu ch√∫ng ta coi Parser l√† m·ªôt function c√≥ input l√† String v√† output l√† m·ªôt structured data; th√¨ parser combinator l√† m·ªôt higher-order function nh·∫≠n m·ªôt ho·∫∑c nhi·ªÅu parser v√† k·∫øt h·ª£p ch√∫ng l·∫°i th√†nh m·ªôt parser m·ªõi. √ù t∆∞·ªüng ·ªü ƒë√¢y l√† ch√∫ng ta c√≥ th·ªÉ d√πng c√°c parser ƒë∆°n gi·∫£n v√† g·ªôp ch√∫ng l·∫°i b·∫±ng c√°c parser combinator ƒë·ªÉ gi·∫£i quy·∫øt c√°c b√†i to√°n ph·ª©c t·∫°p h∆°n.</p><p>M·ªôt s·ªë v√≠ d·ª• b√†i to√°n v·ªÅ parsing nh∆∞: compiler c·∫ßn parse source code th√†nh <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree" target="_blank" rel="noopener noreferrer">Abstract Syntax Tree/AST</a> ho·∫∑c m·ªôt chu·ªói c√°c token (n·∫øu compiler t√°ch ri√™ng <a href="/grox/docs/book/scanning">scanning</a>); json parser s·∫Ω parser json string th√†nh c√°c data class.</p><p>Sau ƒë√¢y m√¨nh s·∫Ω s·ª≠ d·ª•ng ng√¥n ng·ªØ <a href="https://docs.scala-lang.org/scala3/getting-started.html" target="_blank" rel="noopener noreferrer">Scala 3</a> v√† th∆∞ vi·ªán <a href="https://github.com/typelevel/cats-parse" target="_blank" rel="noopener noreferrer">cats-parse</a> ƒë·ªÉ gi·∫£i th√≠ch v·ªÅ parser combinator nh∆∞ng tr∆∞·ªõc h·∫øt h√£y b·∫Øt ƒë·∫ßu b·∫±ng vi·ªác kh√°m ph√° type c·ªßa parser<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="parser-representation">Parser representation<a class="hash-link" href="#parser-representation" title="Direct link to heading">‚Äã</a></h2><p>Nh∆∞ ch√∫ng ta ƒë√£ n√≥i ·ªü tr√™n, parser l√† m·ªôt function nh·∫≠n String v√† tr·∫£ v·ªÅ m·ªôt k·∫øt qu·∫£ m√† ch√∫ng ta ƒëang mong ƒë·ª£i. T·ª´ ƒë√≥ ch√∫ng ta c√≥ th·ªÉ ƒë·ªãnh nghƒ©a parser nh∆∞ sau:</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">type Parser[A] = String =&gt; A</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Type nh∆∞ v·∫≠y th√¨ ƒë∆°n gi·∫£n nh∆∞ng ch∆∞a ƒë·ªß. ƒêi·ªÅu ƒë·∫ßu ti√™n ch√∫ng ta th·∫•y l√† kh√¥ng ph·∫£i l√∫c n√†o c≈©ng c√≥ th·ªÉ parse th√†nh c√¥ng. Khi input kh√¥ng ƒë√∫ng c√∫ ph√°p th√¨ parser ph·∫£i tr·∫£ v·ªÅ l·ªói t∆∞∆°ng ·ª©ng. V√† trong th·∫ø gi·ªõi c·ªßa Functional Programming th√¨ ch√∫ng ta ph·∫£i th·ªÉ hi·ªán ƒëi·ªÅu ƒë√≥ khi khai b√°o ki·ªÉu cho parser. Sau ƒë√¢y l√† ƒë·ªãnh nghƒ©a m·ªõi c·ªßa parser b·∫±ng c√°ch s·ª≠ d·ª•ng Either <sup id="fnref-either"><a href="#fn-either" class="footnote-ref">either</a></sup></p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">type Parser[A] = String =&gt; Either[ParseError, A]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>ƒêi·ªÅu ti·∫øp theo l√† nh∆∞ ch√∫ng ta ƒë√£ n√≥i ·ªü tr√™n v·ªÅ parser combinator, ch√∫ng ta kh√¥ng mu·ªën vi·∫øt m·ªôt c√°i parser ph·ª©c t·∫°p m·ªôt l·∫ßn duy nh·∫•t, m√† ch√∫ng ta mu·ªën vi·∫øt nh·ªØng parser ƒë∆°n gi·∫£n, c∆° b·∫£n r·ªìi k·∫øt h·ª£p ch√∫ng l·∫°i v·ªõi nhau. V√≠ d·ª• nh∆∞ khi parse m·ªôt bi·ªÉu th·ª©c to√°n h·ªçc ƒë∆°n gi·∫£n nh∆∞ sau <code>(3 + 5) * 4</code> ch√∫ng ta s·∫Ω vi·∫øt m·ªôt c√°i parser cho d·∫•u <code>(</code> r·ªìi m·ªôt parser kh√°c cho s·ªë t·ª± nhi√™n, r·ªìi c√°c ph√©p to√°n ... Do ƒë√≥ parser c·ªßa ch√∫ng ta kh√¥ng n√™n ti√™u th·ª• ho√†n to√†n String input m√† ch·ªâ n√™n s·ª≠ d·ª•ng m·ªôt ph·∫ßn v√† tr·∫£ v·ªÅ ph·∫ßn c√≤n l·∫°i cho c√°c parser ti·∫øp theo ti√™u th·ª•. T·ª´ ƒë√≥ ch√∫ng ta c√≥ m·ªôt ƒë·ªãnh nghƒ©a m√† ch√∫ng ta c√≥ th·ªÉ tho√£ m√£n nh∆∞ sau:</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">type Parser[A] = String =&gt; Either[Parser.Error, (String, A)]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Trong th·ª±c t·∫ø th√¨ Parser ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a ph·ª©c t·∫°p h∆°n m·ªôt x√≠u nh∆∞ sau:</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">sealed abstract class Parser[+A] {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final def parse(str: String): Either[Parser.Error, (String, A)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Attempt to parse all of the input `str` into an `A` value.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final def parseAll(str: String): Either[Parser.Error, A]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="parser-with-cats">Parser with cats<a class="hash-link" href="#parser-with-cats" title="Direct link to heading">‚Äã</a></h2><p>Sau khi ƒë√£ c√≥ ƒë·ªãnh nghƒ©a c·ªßa parser, ch√∫ng ta s·∫Ω kh√°m c√°ch s·ª≠ d·ª•ng parser v√† parser combinator b·∫±ng library <a href="https://github.com/typelevel/cats-parse" target="_blank" rel="noopener noreferrer">cats-parse</a> - m·ªôt trong nh·ªØng parser combinators library cho ng√¥n ng·ªØ Scala. C√°c ph·∫ßn sau ƒëa ph·∫ßn ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ <a href="https://github.com/typelevel/cats-parse#readme" target="_blank" rel="noopener noreferrer">cats-parse</a> v·ªõi m·ªôt s·ªë ch·ªânh s·ª≠a.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="simple-parsers">Simple Parsers<a class="hash-link" href="#simple-parsers" title="Direct link to heading">‚Äã</a></h3><p>Library cats-parse cung c·∫•p m·ªôt t·∫≠p h·ª£p c√°c parser c∆° b·∫£n, ƒë·ªÉ t·∫°o th√†nh c√°c building block cho b·∫•t c·ª© parser ph·ª©c t·∫°p n√†o.</p><p>ƒê·∫ßu ti√™n l√† <code>Parser.anyChar</code>, l√† m·ªôt parser lu√¥n lu√¥n tr·∫£ v·ªÅ k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói input (fail trong tr∆∞·ªùng h·ª£p ƒë·∫ßu v√†o l√† m·ªôt empty string).</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">val p: Parser[Char] = Parser.anyChar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p.parse(&quot;t&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Right((,t))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p.parse(&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Left(Error(0,NonEmptyList(InRange(0,,))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p.parse(&quot;two&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Right((wo,t))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><code>Parser.string</code> l√† parser m√† n√≥ s·∫Ω parse th√†nh c√¥ng n·∫øu string input b·∫Øt ƒë·∫ßu v·ªõi gi√° tr·ªã c·ªßa <code>str</code>. Ch√∫ √Ω r·∫±ng <code>Parser.string</code> s·∫Ω tr·∫£ v·ªÅ m·ªôt parser c√≥ type l√† <code>Parser[Unit]</code>, ƒëi·ªÅu ƒë√≥ c√≥ nghƒ©a l√† n√≥ s·∫Ω tr·∫£ v·ªÅ <code>Unit</code> n·∫øu th√†nh c√¥ng.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">val p: Parser[Unit] = Parser.string(&quot;hello&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p.parse(&quot;hello&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Unit]] = Right((,()))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p.parse(&quot;hell&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Unit]] = Left(Error(0,NonEmptyList(OneOfStr(0,List(hello)))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p.parse(&quot;hello world&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Unit]] = Right(( world ,hello))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><code>sp</code> t∆∞∆°ng t·ª± nh∆∞ <code>Parser.anyChar</code> nh∆∞ng ch·ªâ ƒë√∫ng khi k√Ω t·ª± ƒë·∫ßu ti√™n l√† k√Ω t·ª± kho·∫£ng tr·∫Øng.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">import cats.parse.Rfc5234.sp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sp.parse(&quot; &quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Unit]] = Right((,()))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sp.parse(&quot;o_o&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Unit]] = Left(Error(0,NonEmptyList(InRange(0, , ))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><code>alpha</code> t∆∞∆°ng t·ª± nh∆∞ <code>Parser.anyChar</code> nh∆∞ng ch·ªâ ƒë√∫ng khi k√Ω t·ª± ƒë·∫ßu ti√™n l√† k√Ω t·ª± alphabet.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">import cats.parse.Rfc5234.alpha</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alpha.parse(&quot;z&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Right((,z))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alpha.parse(&quot;3&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Left(Error(0,NonEmptyList(InRange(0,A,Z), InRange(0,a,z))))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><code>digit</code> t∆∞∆°ng t·ª± nh∆∞ <code>Parser.alpha</code> nh∆∞ng ch·ªâ ƒë√∫ng khi k√Ω t·ª± ƒë·∫ßu ti√™n l√† k√Ω t·ª± t·ª´ 0-9</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">import cats.parse.Rfc5234.digit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">digit.parse(&quot;3&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Right((,3))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">digit.parse(&quot;z&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//  Either[Error, Tuple2[String, Char]] = Left(Error(0,NonEmptyList(InRange(0,0,9))))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><code>Parser.charIn</code> nh·∫≠n m·ªôt string ƒë·∫ßu v√†o v√† tr·∫£ v·ªÅ m·ªôt parser m√† n√≥ s·∫Ω parse th√†nh c√¥ng n·∫øu k√Ω t·ª± ƒë·∫ßu ti√™n l√† m·ªôt character trong string ƒë·∫ßu v√†o.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">val charIn = Parser.charIn(&quot;123456789&quot;) // t∆∞∆°ng ƒë∆∞∆°ng v·ªõi digit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">charIn.parse(&quot;3&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Right((,3))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="mapping-output">Mapping Output<a class="hash-link" href="#mapping-output" title="Direct link to heading">‚Äã</a></h3><p>ƒê·∫ßu ra c·ªßa parser c√≥ th·ªÉ ƒë∆∞·ª£c x·ª≠ l√Ω b·∫±ng <code>map</code> function.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">case class CharWrapper(value: Char)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p: Parser[CharWrapper] = Parser.anyChar.map(char =&gt; CharWrapper(char))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p.parse(&quot;t&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Right((,CharWrapper(t)))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Library cung c·∫•p s·∫µn m·ªôt s·ªë h√†m cho ƒë·ªÉ mapping sang type <code>String</code> v√† <code>Unit</code> d·ªÖ d√†ng h∆°n</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">/* String */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p2: Parser[String] = digit.map((c: Char) =&gt; c.toString)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// t∆∞∆°ng ƒë∆∞∆°ng v·ªõi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p3: Parser[String] = digit.string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p3.parse(&quot;1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, String]] = Right((,1))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/* Unit */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p4: Parser[Unit] = digit.map(_ =&gt; ())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// t∆∞∆°ng ƒë∆∞∆°ng v·ªõi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p5: Parser[Unit] = digit.void</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p5.parse(&quot;1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Unit]] = Right((,()))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><em>Ch√∫ √Ω</em>: <code>string</code> s·∫Ω tr·∫£ v·ªÅ input m√† parser ƒë√£ s·ª≠ d·ª•ng, v√† b·ªè qua output.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="combinging-parsers">Combinging parsers<a class="hash-link" href="#combinging-parsers" title="Direct link to heading">‚Äã</a></h3><p>C√°c parser c√≥ th·ªÉ k·∫øt h·ª£p v·ªõi nhau b·∫±ng c√°c operator sau:</p><ul><li><code>~</code> - <code>product</code> - Ti·∫øp t·ª•c parsing parser th·ª© 2 n·∫øu parser ƒë·∫ßu ti√™n th√†nh c√¥ng;</li><li><code>&lt;*</code> - <code>productL</code> - Nh∆∞ h√†m <code>product</code> nh∆∞ng b·ªè qua k·∫øt qu·∫£ c·ªßa parser th·ª© 2;</li><li><code>*&gt;</code> - <code>productR</code> - Nh∆∞ h√†m <code>product</code> nh∆∞ng b·ªè qua k·∫øt qu·∫£ c·ªßa parser ƒë·∫ßu ti√™n;</li><li><code>suroundedBy</code> - t∆∞∆°ng ƒë∆∞∆°ng v·ªõi <code>border *&gt; parsingResult &lt;* border</code>;</li><li><code>between</code> - t∆∞∆°ng ƒë∆∞∆°ng v·ªõi <code>border1 *&gt; parsingResult &lt;* border2</code>;</li><li><code>|</code> - <code>orElse</code> - Parser th√†nh c√¥ng n·∫øu m·ªôt trong hai parser ƒë·∫ßu v√†o th√†nh c√¥ng;</li></ul><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">import cats.parse.Rfc5234.{sp, alpha, digit}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import cats.parse.Parser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/* Product */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// product</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p1: Parser[(Char, Unit)] = alpha ~ sp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p1.parse(&quot;t&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Tuple2[Char, Unit]]] = Left(Error(1,NonEmptyList(InRange(1, , ))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p1.parse(&quot;t &quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Tuple2[Char, Unit]]] = Right((,(t,())))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/* productL, productR */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// T∆∞∆°ng t·ª± nh∆∞ `p1` nh∆∞ng ƒë·∫ßu ra s·∫Ω c√≥ type l√† `Parser[Char]` thay v√¨ `Tuple2`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// v√¨ &lt;* s·∫Ω b·ªè qu·∫£ k·∫øt qu·∫£ c·ªßa parser ph√≠a b√™n tr√°i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p2: Parser[Char] = alpha &lt;* sp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p2.parse(&quot;t&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Left(Error(1,NonEmptyList(InRange(1, , ))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p2.parse(&quot;t &quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Right((,t))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Ch√∫ √Ω n·∫øu mu·ªën b·ªè qua k·∫øt qu·∫£ c·ªßa alpha th√¨ chuy·ªÉn m≈©i t√™n</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p21: Parser[Unit] = alpha *&gt; sp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/* surroundedBy */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p4: Parser[Char] = sp *&gt; alpha &lt;* sp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p5: Parser[Char] = alpha.surroundedBy(sp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p4.parse(&quot; a &quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Right((,a))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p5.parse(&quot; a &quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Right((,a))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/* between */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p6: Parser[Char] = sp *&gt; alpha &lt;* digit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p7: Parser[Char] = alpha.between(sp, digit)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p6.parse(&quot; a1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Right((,a))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p7.parse(&quot; a1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Right((,a))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/* OrElse */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p3: Parser[AnyVal] = alpha | sp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p3.parse(&quot;t&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, AnyVal]] = Right((,t))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p3.parse(&quot; &quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, AnyVal]] = Right((,()))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="repeating-parsers">Repeating parsers<a class="hash-link" href="#repeating-parsers" title="Direct link to heading">‚Äã</a></h3><p><code>cats-parse</code> cung c·∫•p 2 function ƒë·ªÉ ch√∫ng ta bi·∫øn m·ªôt Parser<!-- -->[A]<!-- --> th√†nh Paser[List<!-- -->[A]<!-- -->] ƒë√≥ l√† <code>rep</code> v√† <code>rep0</code>. V·ªõi <code>rep</code> parser c·∫ßn ph·∫£i parse th√†nh c√¥ng √≠t nh·∫•t m·ªôt ph·∫ßn t·ª≠, c√≤n <code>rep0</code> th√¨ c√≥ th·ªÉ cho ra m·ªôt List r·ªóng.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">val number: Parser[NonEmptyList[Char]] = digit.rep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val numberOrNone: Parser0[List[Char]] = digit.rep0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">number.parse(&quot;73&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, NonEmptyList[Char]]] = Right((,NonEmptyList(7, 3)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">number.parse(&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, NonEmptyList[Char]]] = Left(Error(0,NonEmptyList(InRange(0,0,9))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">numberOrNone.parse(&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, List[Char]]] = Right((,List()))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">numberOrNone.parse(&quot;73&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, List[Char]]] = Right((,List(7, 3)))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>Ch√∫ √Ω</strong>: type c·ªßa number v√† numberOrNone l√† kh√°c nhau. <code>Parser</code> type lu√¥n lu√¥n tr·∫£ v·ªÅ non-empty ouput, c√≤n <code>Parser0</code> th√¨ c√≥ th·ªÉ empty(trong tr∆∞·ªùng h·ª£p th√†nh c√¥ng).</p><p><code>rep</code> v√† <code>rep0</code> c√≥ th·ªÉ k·∫øt h·ª£p v·ªõi <code>string</code> function m√† ch√∫ng ta ƒë√£ nh·∫Øc ƒë·∫øn ·ªü tr√™n.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">val word1 = alpha.rep.map((l: NonEmptyList[Char]) =&gt; l.toList.mkString)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val word2 = alpha.rep.string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val word2 = alpha.repAs[String]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">word1.parse(&quot;bla&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, String]] = Right((,bla))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>3 parser ·ªü tr√™n ho√†n to√†n gi·ªëng nhau v·ªÅ m·∫∑t k·∫øt qu·∫£, nh∆∞ng 2 parser sau s·∫Ω t·ªëi ∆∞u h∆°n v√¨ ch√∫ng kh√¥ng ph·∫£i t·∫°o ra List trung gian</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parsers-with-empty-output">Parsers with empty output<a class="hash-link" href="#parsers-with-empty-output" title="Direct link to heading">‚Äã</a></h4><p>C√≥ m·ªôt s·ªë parser kh√¥ng bao gi·ªù tr·∫£ v·ªÅ k·∫øt qu·∫£ v√† type c·ªßa ch√∫ng s·∫Ω l√† <code>Parser0</code>. Ch√∫ng ta c√≥ th·ªÉ chuy·ªÉn type <code>Parser</code> v·ªÅ <code>Parser0</code> b·∫±ng <code>rep0</code> ho·∫∑c <code>?</code> aka <code>optional</code>.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">val p: Parser[String] = (alpha.rep &lt;* sp.?).rep.string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p.parse(&quot;hello world&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, String]] = Right((,hello world))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="error-handling">Error Handling<a class="hash-link" href="#error-handling" title="Direct link to heading">‚Äã</a></h3><p>Nh∆∞ ch√∫ng ta ƒë√£ n√≥i ·ªü ph·∫ßn ƒë·∫ßu ti√™n, m·ªôt parser n·∫øu parse kh√¥ng th√†nh c√¥ng th√¨ s·∫Ω ph·∫£i tr·∫£ v·ªÅ l·ªói. C√≥ 2 ki·ªÉu l·ªói:</p><ul><li><em>epsilon failure</em>: l·ªói m√† parser ch∆∞a s·ª≠ d·ª•ng b·∫•t k·ª≥ m·ªôt character n√†o</li><li><em>arresting failure</em>: l·ªói m√† parser ƒë√£ s·ª≠ d·ª•ng √≠t nh·∫•t m·ªôt character</li></ul><p>V·ªÅ m·∫∑t implementation <code>Parser.Error</code> c√≥ ƒë·ªãnh nghƒ©a nh∆∞ sau:</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">final case class Error(failedAtOffset: Int, expected: NonEmptyList[Expectation])</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>N·∫øu <code>failedAtOffset == 0</code> th√¨ ƒë√≥ l√† <code>epsilon failure</code> v√† <code>arresting failure</code> trong tr∆∞·ªùng h·ª£p c√≤n l·∫°i.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">val p1: Parser[Char] = alpha</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p2: Parser[Char] = sp *&gt; alpha</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// epsilon failure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p1.parse(&quot;123&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Left(Error(0,NonEmptyList(InRange(0,A,Z), InRange(0,a,z))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// arresting failure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p2.parse(&quot; 1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Left(Error(1,NonEmptyList(InRange(1,A,Z), InRange(1,a,z))))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Ch√∫ng ta c·∫ßn ph√¢n bi·ªát hai lo·∫°i l·ªói n√†y v√¨, lo·∫°i ƒë·∫ßu ti√™n cho ch√∫ng ta bi·∫øt parser kh√¥ng kh·ªõp v·ªõi input ƒë·∫ßu v√†o ngay khi b·∫Øt ƒë·∫ßu parse, v√† lo·∫°i th·ª© 2 x·∫£y ra trong qu√° tr√¨nh parse.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="backtrack">Backtrack<a class="hash-link" href="#backtrack" title="Direct link to heading">‚Äã</a></h3><p>Backtrack l√† m·ªôt function gi√∫p ch√∫ng ta chuy·ªÉn <em>arresting failure</em> th√†nh <em>epsilon failure</em>. N√≥ c≈©ng gi√∫p tua l·∫°i offset c·ªßa input v·ªÅ tr∆∞·ªõc khi parser b·∫Øt ƒë·∫ßu. ƒê√¢y l√† m·ªôt function c·ª±c k·ª≥ h·ªØu d·ª•ng khi ch√∫ng ta mu·ªën k·∫øt h·ª£p nhi·ªÅu parser l·∫°i v·ªõi nhau.</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">val p1 = sp *&gt; digit &lt;* sp // _digit_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p2 = sp *&gt; digit // _digit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p1.parse(&quot; 1&quot;) // (1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Left(Error(2,NonEmptyList(InRange(2, , ))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(p1 | p2 ).parse(&quot; 1&quot;) // (2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Left(Error(2,NonEmptyList(InRange(2, , ))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(p1.backtrack | p2 ).parse(&quot; 1&quot;) (3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Either[Error, Tuple2[String, Char]] = Right((,1))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Parser(2) tr·∫£ v·ªÅ l·ªói b·ªüi v√¨ p1 tr·∫£ v·ªÅ <em>arresting failure</em> v√† operator <code>|</code> ch·ªâ c√≥ th·ªÉ ph·ª•c h·ªìi v·ªõi <em>epsilon failure</em>.</p><p>Parser(3) parse th√†nh c√¥ng v√¨ <code>backtrack</code> chuy·ªÉn <em>arresting failure</em> th√†nh <em>epsilon failure</em> n√™n sau khi th·∫•t b·∫°i v·ªõi <code>p1.backtrack</code> (3) s·∫Ω ti·∫øp t·ª•c v·ªõi <code>p2</code> v√† th√†nh c√¥ng.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="soft">Soft<a class="hash-link" href="#soft" title="Direct link to heading">‚Äã</a></h3><p>C√≥ hi·ªáu ·ª©ng t∆∞∆°ng t·ª± nh∆∞ <code>backtrack</code> v·ªõi <code>|</code>, nh∆∞ng v·ªõi operator <code>~</code> v√† n√≥ cho ph√©p ch√∫ng ta ti·∫øp t·ª•c parsing khi to√°n t·ª≠ b√™n ph·∫£i tr·∫£ v·ªÅ <code>epsilon failure</code>. N√≥ r·∫•t h·ªØu √≠ch trong tr∆∞·ªùng h·ª£p ch√∫ng ta kh√¥ng bi·∫øt ch√≠nh x√°c output m√† ch√∫ng ta c·∫ßn tr∆∞·ªõc khi qu√° tr√¨nh parsing k·∫øt th√∫c. Nh∆∞ v√≠ d·ª• d∆∞·ªõi ƒë√¢y ch√∫ng ta parse ƒë·∫ßu v√†o cho m·ªôt search engine. Input c√≥ th·ªÉ c√≥ d·∫°ng <code>key:value</code> ho·∫∑c ch·ªâ m·ªói <code>value</code></p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">val searchWord = (alpha.rep.string ~ sp.?).rep.string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val fieldValue = alpha.rep.string ~ pchar(&#x27;:&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val fieldValueSoft = alpha.rep.string.soft ~ pchar(&#x27;:&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p1 = fieldValue.? ~ searchWord</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val p2 = fieldValueSoft.? ~ searchWord</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p2.parse(&quot;title:The Wind Has Risen&quot;) (1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Right((,(Some((title,())),The Wind Has Risen)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p2.parse(&quot;The Wind Has Risen&quot;) // (2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Right((,(None,The Wind Has Risen)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p1.parse(&quot;The Wind Has Risen&quot;) // (3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Left(Error(3,NonEmptyList(InRange(3,:,:))))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Parser <code>p2</code> parse th√†nh c√¥ng ·ªü (2) trong khi <code>p1</code> th·∫•t b·∫°i ·ªü (3) b·ªüi v√¨ <code>fieldValueSoft</code> tr·∫£ v·ªÅ <em>epsilon failure</em> v·ªõi s·ª± gi√∫p ƒë·ª° c·ªßa <code>soft</code> t·ª´ ƒë√≥ <code>p2</code> c√≥ th·ªÉ ti·∫øp t·ª•c parsing v·ªõi <code>searchWord</code> trong khi <code>p1</code> tr·∫£ v·ªÅ l·ªói v√¨ n√≥ nh·∫≠n ƒë∆∞·ª£c <em>arresting failure</em> t·ª´ <code>failValue</code> parser.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">‚Äã</a></h2><ul><li><a href="https://hasura.io/blog/parser-combinators-walkthrough" target="_blank" rel="noopener noreferrer">Parser Combinators Walkthrough</a></li><li><a href="https://github.com/typelevel/cats-parse" target="_blank" rel="noopener noreferrer">cats-parse</a></li><li><a href="https://tgdwyer.github.io/parsercombinators/" target="_blank" rel="noopener noreferrer">Parser Combinators tutorial in Haskell</a></li></ul><div class="footnotes"><hr><ol><li id="fn-1"><p>Trong ph·∫ßn ƒë·∫ßu m√¨nh s·∫Ω s·ª≠ d·ª•ng pseudocode, implmentation trong th·ª±c t·∫ø s·∫Ω t∆∞∆°ng t·ª± nh∆∞ng ph·ª©c t·∫°p h∆°n.<a href="#fnref-1" class="footnote-backref">‚Ü©</a></p></li><li id="fn-either"><p><code>Either[E, A]</code> ƒë∆∞·ª£c ƒë·ªãnh ngƒ©a nh∆∞ sau(phi√™n b·∫£n s∆° l∆∞·ª£c):</p><div class="codeBlockContainer_J+bg language-scala theme-code-block"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">  enum Either[E, A] {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case Left(value: E)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case Right(value: A)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>l√† ki·ªÉu d·ªØ li·ªáu m√† n√≥ ƒë·∫°i di·ªán cho 2 kh·∫£ nƒÉng ho·∫∑c l√† Left v·ªõi gi√° tr·ªã c·ªßa type E ho·∫∑c l√† Right v·ªõi gi√° tr·ªã c·ªßa type A. Left th∆∞·ªùng ƒë∆∞·ª£c d√πng ƒë·ªÉ bi·ªÉu th·ªã tr∆∞·ªùng h·ª£p l·ªói, v√† Right cho tr∆∞·ªùng h·ª£p th√†nh c√¥ng.<a href="#fnref-either" class="footnote-backref">‚Ü©</a></p></li></ol></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/../grox-docs/target/mdoc/fp/parser-combinators.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/grox/docs/book/representing-code"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Representing Code</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/grox/docs/resources"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Resources</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#parser-representation" class="table-of-contents__link toc-highlight">Parser representation</a></li><li><a href="#parser-with-cats" class="table-of-contents__link toc-highlight">Parser with cats</a><ul><li><a href="#simple-parsers" class="table-of-contents__link toc-highlight">Simple Parsers</a></li><li><a href="#mapping-output" class="table-of-contents__link toc-highlight">Mapping Output</a></li><li><a href="#combinging-parsers" class="table-of-contents__link toc-highlight">Combinging parsers</a></li><li><a href="#repeating-parsers" class="table-of-contents__link toc-highlight">Repeating parsers</a></li><li><a href="#error-handling" class="table-of-contents__link toc-highlight">Error Handling</a></li><li><a href="#backtrack" class="table-of-contents__link toc-highlight">Backtrack</a></li><li><a href="#soft" class="table-of-contents__link toc-highlight">Soft</a></li></ul></li><li><a href="#resources" class="table-of-contents__link toc-highlight">Resources</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/grox/docs/introduction">The Grox Programming Language</a></li><li class="footer__item"><a class="footer__link-item" href="/grox/docs/resources">Resources</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://www.grokking.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Grokking Vietnam<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.facebook.com/grokking.vietnam/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCH2gAK9r_7EbvyVt0z5VibQ/featured" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Youtube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/grokking-vietnam/grox" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 Grokking Vietnam. Built with Docusaurus.</div></div></div></footer></div>
<script src="/grox/assets/js/runtime~main.cc110788.js"></script>
<script src="/grox/assets/js/main.f2131e7f.js"></script>
</body>
</html>